<template>
  <div class="min-h-screen flex bg-gray-50 justify-center">

    <!-- ì „ì²´ ë˜í¼ -->
    <div class="flex w-full max-w-7xl">

      <!-- Sidebar -->
      <aside class="w-72 bg-white shadow-xl p-8 rounded-r-2xl">
        <h2 class="text-3xl font-extrabold text-sky-600 tracking-tight">
          ëŒ€ì‹œë³´ë“œ
        </h2>

        <!-- â­ ê¸°ì¡´ ì‚¬ìš©ì(User) ë©”ë‰´ -->
        <nav v-if="role === 'USER'" class="mt-10 space-y-3 text-lg">

          <router-link
            to="/dashboard/mypage"
            class="block py-3 px-5 rounded-xl hover:bg-sky-500 hover:text-white transition"
          >
            ğŸ‘¤ ë§ˆì´í˜ì´ì§€
          </router-link>

          <router-link
            to="/dashboard/home"
            class="block py-3 px-5 rounded-xl hover:bg-sky-500 hover:text-white transition"
          >
            ğŸ  í™ˆ
          </router-link>

          <router-link
            to="/dashboard/info"
            class="block py-3 px-5 rounded-xl hover:bg-sky-500 hover:text-white transition"
          >
            ğŸ¥ ë³‘ì› ê²€ìƒ‰
          </router-link>

          <router-link
            to="/dashboard/board-list"
            class="block py-3 px-5 rounded-xl hover:bg-sky-500 hover:text-white transition"
          >
            ğŸ’¬ ì‹¤ì‹œê°„ Q&A
          </router-link>

          <router-link
            to="/dashboard/ai-chat"
            class="block py-3 px-5 rounded-xl hover:bg-sky-500 hover:text-white transition"
          >
            ğŸ¤– AI ì±„íŒ…
          </router-link>

          <router-link
            to="/dashboard/disease-encyclopedia"
            class="block py-3 px-5 rounded-xl hover:bg-sky-500 hover:text-white transition"
          >
            ğŸ“š ì§ˆë³‘ ë°±ê³¼ì‚¬ì „
          </router-link>

          <!-- ë¹„ëŒ€ë©´ ì§„ë£Œ ë“œë¡­ë‹¤ìš´ -->
          <div>
            <button
              @click="toggleTele"
              class="w-full text-left py-3 px-5 rounded-xl hover:bg-sky-500 hover:text-white transition flex justify-between items-center"
            >
              <span>ğŸ’» ë¹„ëŒ€ë©´ ì§„ë£Œ</span>
              <span>{{ teleOpen ? 'â–²' : 'â–¼' }}</span>
            </button>

            <transition name="slide">
              <div v-if="teleOpen" class="ml-4 mt-2 space-y-2">
                <router-link
                  v-for="dept in departments"
                  :key="dept.name"
                  :to="dept.route"
                  class="block py-2 px-4 text-base rounded-lg hover:bg-sky-400 hover:text-white transition"
                >
                  â€¢ {{ dept.name }}
                </router-link>
              </div>
            </transition>
          </div>

        </nav>

        <!-- â­ ì˜ì‚¬ ë©”ë‰´(role === 'DOCTOR'ì¼ ë•Œë§Œ ë³´ì„) -->
        <nav v-if="role === 'DOCTOR'" class="mt-10 space-y-3 text-lg">

          <router-link
            to="/doctor/dashboard"
            class="block py-3 px-5 rounded-xl hover:bg-sky-500 hover:text-white transition"
          >
            ğŸ©º ì˜ì‚¬ í™ˆ
          </router-link>

          <router-link
            to="/doctor/reservations"
            class="block py-3 px-5 rounded-xl hover:bg-sky-500 hover:text-white transition"
          >
            ğŸ“… ì§„ë£Œ ì˜ˆì•½ ê´€ë¦¬
          </router-link>

          <router-link
            to="/doctor/triage"
            class="block py-3 px-5 rounded-xl hover:bg-sky-500 hover:text-white transition"
          >
            ğŸ“ ë¬¸ì§„ ìš”ì²­ ë³´ê¸°
          </router-link>

          <router-link
            to="/doctor/patients"
            class="block py-3 px-5 rounded-xl hover:bg-sky-500 hover:text-white transition"
          >
            ğŸ‘¥ í™˜ì ëª©ë¡
          </router-link>

          <router-link
            to="/doctor/profile"
            class="block py-3 px-5 rounded-xl hover:bg-sky-500 hover:text-white transition"
          >
            ğŸ‘¨â€âš•ï¸ ì˜ì‚¬ ì •ë³´
          </router-link>

        </nav>

      </aside>

      <!-- Main Content -->
      <main class="flex-1 p-10 flex justify-center">
        <div class="w-full max-w-5xl">
          <router-view />
        </div>
      </main>

    </div>
  </div>
</template>

<script>
export default {
  name: "DashboardLayout",
  data() {
    return {
      teleOpen: false,
      role: null,
      departments: [
        { name: "ë‚´ê³¼", route: "/dashboard/telemedicine/ë‚´ê³¼" },
        { name: "í”¼ë¶€ê³¼", route: "/dashboard/telemedicine/í”¼ë¶€ê³¼" },
        { name: "ì •í˜•ì™¸ê³¼", route: "/dashboard/telemedicine/ì •í˜•ì™¸ê³¼" },
        { name: "ì´ë¹„ì¸í›„ê³¼", route: "/dashboard/telemedicine/ì´ë¹„ì¸í›„ê³¼" },
        { name: "ì†Œì•„ê³¼", route: "/dashboard/telemedicine/ì†Œì•„ê³¼" },
        { name: "ì‚°ë¶€ì¸ê³¼", route: "/dashboard/telemedicine/ì‚°ë¶€ì¸ê³¼" },
        { name: "ì‹ ê²½ê³¼", route: "/dashboard/telemedicine/ì‹ ê²½ê³¼" },
        { name: "ë¹„ë‡¨ì˜í•™ê³¼", route: "/dashboard/telemedicine/ë¹„ë‡¨ì˜í•™ê³¼" },
        { name: "ì •ì‹ ê±´ê°•ì˜í•™ê³¼", route: "/dashboard/telemedicine/ì •ì‹ ê±´ê°•ì˜í•™ê³¼" },
        { name: "ì•ˆê³¼", route: "/dashboard/telemedicine/ì•ˆê³¼" },
        { name: "ì¹˜ê³¼", route: "/dashboard/telemedicine/ì¹˜ê³¼" }
      ],
    };
  },
  created() {
    const user = JSON.parse(localStorage.getItem("user"));
    this.role = user?.role; // ROLE_USER / ROLE_DOCTOR / ROLE_ADMIN ì €ì¥ë˜ì–´ ìˆì„ ê²ƒ
    if (this.role && this.role.startsWith("ROLE_")) {
      this.role = this.role.replace("ROLE_", ""); // DOCTOR/USER ë“±ìœ¼ë¡œ ì •ë¦¬
    }
  },
  methods: {
    toggleTele() {
      this.teleOpen = !this.teleOpen;
    },
  },
};
</script>

<style>
.slide-enter-active,
.slide-leave-active {
  transition: all 0.25s ease;
}
.slide-enter-from,
.slide-leave-to {
  opacity: 0;
  transform: translateY(-8px);
}
</style>
